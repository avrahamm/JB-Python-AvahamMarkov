Solution doesn't work properly,
there is bug I didn't solve.
Yet you can look at pseudo code idea.