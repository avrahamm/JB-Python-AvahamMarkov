Solution doesn't work properly,
there is bug I didn't solve.
Yet you can look at pseudo code idea.

Later, I fixed the bug and created 'fixed-solution' branch.
You can take a look on that branch,
it works with example inputs.